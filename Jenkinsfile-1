pipeline {
  agent any

  stages {
    pipeline {
    agent { docker { image 'node:16.17.1-alpine' } }
    stages {
        stage('build') {
            steps {
                sh 'node --version'
                sh 'npm install'
                sh 'npm run build'
            }
        }
    }
}

    stage('Code Analysis') {
      environment {
        SONAR_LOGIN = credentials('sq-token')
      }
      steps {
        withSonarQubeEnv('SonarQube') {
          sh 'sonar-scanner -Dsonar.login=$SONAR_LOGIN -Dsonar.projectKey=sq-inner -Dsonar.sources=. -Dsonar.projectName=sq-inner'
        }
      }
    }
  }
}



pipeline {
    agent { docker { image 'node:16.17.1-alpine' } }
    stages {
        stage('build') {
            steps {
                sh 'node --version'
            }
        }
    }
}
